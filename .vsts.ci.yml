jobs:

################################################################################
- job: build_linux_arm_agent
################################################################################
  displayName: Linux Agent (ARM)
  pool:
    name: default
    demands: 'Agent.OSArchitecture -equals ARM'
  steps:

  # Steps template for non-windows platform
  - template: .vsts.template.nonwindows.yml

  # Create agent package zip
  - script: ./dev.sh package Release
    workingDirectory: src
    displayName: Package Release
    condition: and(succeeded(), ne(variables['build.reason'], 'PullRequest'))

  # Upload agent package zip as build artifact
  - task: PublishBuildArtifacts@1
    displayName: Publish Artifact (Linux ARM)
    condition: and(succeeded(), ne(variables['build.reason'], 'PullRequest'))
    inputs:
      pathToPublish: _package
      artifactName: agent
      artifactType: container
